%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% GRUMEC
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Lagrangian position (inital configuration) vector
\newcommand{\lPosition}{\mathbf{x}}
\newcommand{\lDomain}{_{\Omega}_x}
\newcommand{\lBoundary}{\Gamma_x}
%Eulerian position (current configuration) vector
\newcommand{\ePosition}{\mathbf{y}}
\newcommand{\eDomain}{\Omega_y}
\newcommand{\eBoundary}{\Gamma_y}
%rigth Cauchy-Green stretch tensor
\newcommand{\cauchyStretch}{\mathbf{C}}
\newcommand{\constitutiveTensor}{\mathbb{C}}
%Green-Lagrange strain tensor
\newcommand{\greenStrain}{\mathbf{E}}
\newcommand{\piolaStress}{\mathbf{S}}
\newcommand{\cauchyStress}{\bm{\sigma}}
%Configuration change function
\newcommand{\fmap}{\mathbf{f}}
\newcommand{\deformation}{\mathbfcal{F}}
\newcommand{\lDeformation}{\mathbfcal{F}_x^h}
\newcommand{\eDeformation}{\mathbfcal{F}_y^h}
\newcommand{\lMedDeformation}{\mathbfcal{F}_x^{mh}}
\newcommand{\eMedDeformation}{\mathbfcal{F}_y^{mh}}
%%Gradient of Configuration change function
\newcommand{\gradDeformation}{\mathbf{A}}
\newcommand{\lGradDeformation}{\mathbf{A}_x^h}
\newcommand{\eGradDeformation}{\mathbf{A}_y^h}
\newcommand{\lMedGradDeformation}{\mathbf{A}_x^{mh}}
\newcommand{\eMedGradDeformation}{\mathbf{A}_y^{mh}}
%%Maping to initial
\newcommand{\initDeformation}{\mathbfcal{F}_0}
%%Gradient of maping to initial
\newcommand{\gradInitDeformation}{\mathbf{A}_0}
\newcommand{\jacobianDeformation}{J}
%strain tensor
\newcommand{\straintensor}{\bm{\varepsilon}}

\newcommand{\totalEnergy}{\Pi}
\newcommand{\extEnergy}{\mathbb{P}}
\newcommand{\kinEnergy}{\mathbb{K}}
\newcommand{\intEnergy}{\mathbb{U}_e}
\newcommand{\concLoad}{\mathbf{F}}
\newcommand{\ebodyLoad}{\mathbf{b}}
\newcommand{\bodyLoad}{\mathbf{b}_0}
\newcommand{\tractionLoad}{\mathbf{p}}
\newcommand{\ltractionLoad}{\mathbf{p}_{0}}
\newcommand{\solidVel}{\dot{\mathbf{y}}}
\newcommand{\solidVelh}{\dot{\mathbf{y}^h}}
\newcommand{\solidAccel}{\ddot{\mathbf{y}}}
\newcommand{\specificEnergy}{u_e}
\newcommand{\bulkModulus}{\kappa}
\newcommand{\shearModulus}{G}
\newcommand{\elasticModulus}{\mathbb{E}}
\newcommand{\lameParameter}{\lambda}
\newcommand{\SVKenergy}{u_e^{SVK}}

\newcommand{\intLoads}{\mathbf{F}^{int}}
\newcommand{\extLoads}{\mathbf{F}^{ext}}
\newcommand{\solidMass}{\mathbf{M}}
\newcommand{\solidDamping}{\mathbf{C}}
\newcommand{\solidHessian}{\mathbf{H}}

\newcommand{\SolidInitPos}{\mathbf{X}}
\newcommand{\SolidPos}{\mathbf{Y}}
\newcommand{\SolidVel}{\dot{\mathbf{Y}}}
\newcommand{\SolidAccel}{\ddot{\mathbf{Y}}}

\newcommand{\lGenVector}{\mathbf{g}_x}
\newcommand{\eGenVector}{\mathbf{g}_y}
\newcommand{\lUnitVector}{\mathbf{e}_x}
\newcommand{\eUnitVector}{\mathbf{e}_y}
\newcommand{\lThickness}{h_x}
\newcommand{\eThickness}{h_y}
\newcommand{\stRate}{a}
\newcommand{\lTheta}{\theta_x}
\newcommand{\eTheta}{\theta_y}
\newcommand{\NNSS}{\mathbf{R}_S}
\newcommand{\lGrad}{\boldsymbol{\nabla}_{\mathbf{x}}}

\newcommand{\poisonsRatio}{\nu}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% GRUMEC - TIME INTEGRATION
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Alpha_f
\newcommand{\alphaf}{\alpha_f}
%alpha_m
\newcommand{\alpham}{\alpha_m}
%spectral radius
\newcommand{\specRadius}{\rho_\infty}
%time
\newcommand{\tempo}{t}
%time step
\newcommand{\timeStep}{\Delta t}
%initial velocity
\newcommand{\initialVelocity}{\mathbf{u}_s^h}
%Total time
\newcommand{\totalTime}{T}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% GRUMEC - ARLEQUIN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Global model
\newcommand{\globalModel}{\Omega_0}
\newcommand{\globalBoundary}{\Gamma_0}
\newcommand{\globalBoundaryN}{\Gamma_{N0}}
%Arlequin model
\newcommand{\arlqModel}{\Omega_i}
\newcommand{\arlqBoundary}{\Gamma_i}

%Local model
\newcommand{\localModel}{\Omega_1}
\newcommand{\localBoundary}{\Gamma_1}
\newcommand{\localBoundaryN}{\Gamma_{N1}}
%Gluing zone
\newcommand{\gluingZone}{\Omega_c}
%Free zone
\newcommand{\freeZone}{\Omega_{fr}}
%Overlapping Zone
\newcommand{\overlappingZone}{\Omega_s}
%Weighting function
\newcommand{\arlequinWF}{\alpha}
\newcommand{\arlequinWFi}{\alpha_i}
%weigthing function local model
\newcommand{\arlequinWFLocal}{\alpha_1}
%weighting function global model
\newcommand{\arlequinWFGlobal}{\alpha_0}

%local velocity
\newcommand{\ulocal}{\mathbf{u}_1}
\newcommand{\ulocalh}{\mathbf{u}_1^h}
%global velocity
\newcommand{\uglobal}{\mathbf{u}_0}
\newcommand{\uglobalh}{\mathbf{u}_0^h}
%velocity Arlequin from model i
\newcommand{\uArlqi}{\mathbf{u}_i^{h}}
%global velocity weight function
\newcommand{\wglobal}{\mathbf{w}_0}
\newcommand{\wglobalh}{\mathbf{w}_0^h}
%local velocity weight function
\newcommand{\wlocal}{\mathbf{w}_1}
%global velocity weight function
\newcommand{\wlocalh}{\mathbf{w}_1^h}
%velocity Arlequin weight function from model i
\newcommand{\wArlqi}{\mathbf{w}_i^h}

%global pressure
\newcommand{\pglobal}{p_0}
\newcommand{\pglobalh}{p_0^h}
%local pressure
\newcommand{\plocal}{p_1}
\newcommand{\plocalh}{p_1^h}
%pressure Alequin from model i
\newcommand{\pArlqi}{p_i^{h}}
%global pressure weight function
\newcommand{\qglobal}{q_0}
\newcommand{\qglobalh}{q_0^h}
%local pressure weight function
\newcommand{\qlocal}{q_1}
\newcommand{\qlocalh}{q_1^h}
%pressure Arlequin weight function from model i
\newcommand{\qArlqi}{q_i^h}

%Surface and body forces in each model
\newcommand{\globalSurfaceLoadh}{\mathbf{h}_0^h}
\newcommand{\localSurfaceLoadh}{\mathbf{h}_1^h}
\newcommand{\arlqSurfaceLoadh}{\mathbf{h}_i^h}
\newcommand{\globalsbodyforceh}{\mathbf{f}_0^h}
\newcommand{\localsbodyforceh}{\mathbf{f}_1^h}
\newcommand{\arlqsbodyforceh}{\mathbf{f}_i^h}

%Lagrange multiplier
\newcommand{\lagrangeMultiplier}{\boldsymbol{\lambda}}
\newcommand{\LagrangeMultiplier}{\boldsymbol{\Lambda}}
\newcommand{\lagrangeMultiplierh}{\boldsymbol{\lambda}^h}
%Lagrange multiplier weight function
\newcommand{\lagrangeMultiplierWF}{\boldsymbol{\zeta}}
\newcommand{\lagrangeMultiplierWFh}{\boldsymbol{\zeta}^h}

%Trial and test spaces
%Solution space global model - velocity
\newcommand{\uGlobalSolution}{\mathcal{S}_{u0}^h}
%Solution space local model - velocity
\newcommand{\uLocalSolution}{\mathcal{S}_{u1}^h}
%Solution space Arlequin model - velocity
\newcommand{\uArlequinSolution}{\mathcal{S}_{ui}^h}
%Solution space global model - velocity
\newcommand{\uGlobalTest}{\mathcal{V}_{u0}^h}
%Solution space global model - velocity
\newcommand{\uLocalTest}{\mathcal{V}_{u1}^h}
%Solution space Arlequin model - velocity
\newcommand{\uArlequinTest}{\mathcal{V}_{ui}^h}

%Solution space global model - pressure
\newcommand{\pGlobalSolution}{\mathcal{S}_{p0}^h}
%Solution space local model - pressure
\newcommand{\pLocalSolution}{\mathcal{S}_{p1}^h}
%Solution space Arlequin model - pressure
\newcommand{\pArlequinSolution}{\mathcal{S}_{pi}^h}
%Solution space global model - pressure
\newcommand{\pGlobalTest}{\mathcal{V}_{p0}^h}
%Solution space global model - pressureÂ´
\newcommand{\pLocalTest}{\mathcal{V}_{p1}^h}
%Solution space Arlequin model - pressure
\newcommand{\pArlequinTest}{\mathcal{V}_{pi}^h}

%Solution space global model - lagrange multiplier
\newcommand{\lagSolution}{\mathcal{M}^h}
%Solution space global model - lagrange multiplier
\newcommand{\lagTest}{\mathcal{Q}^h}

%Arlequin Stabilization Parameter
\newcommand{\tauArlequin}{\tau_{ARLQ}}
\newcommand{\tauArlequini}{\tau_{ARLQi}}
\newcommand{\tauArlequinGlobal}{\tau_{ARLQ0}}
\newcommand{\tauArlequinLocal}{\tau_{ARLQ1}}
%Number of subdomains
\newcommand{\nSubDomains}{n_{dom}}

\newcommand{\resMomGlobal}{\mathbf{r}_{\mathrm{M0}}^{h}}
\newcommand{\resMomI}{\mathbf{r}_{\mathrm{Mi}}^{h}}
\newcommand{\resMomLocal}{\mathbf{r}_{\mathrm{M1}}^{h}}
\newcommand{\resPreGlobal}{r_{\mathrm{C0}}^{h}}
\newcommand{\resPreI}{r_{\mathrm{Ci}}^{h}}
\newcommand{\resPreLocal}{r_{\mathrm{C1}}^{h}}

\newcommand{\NNSL}{\mathrm{R}_\mathrm{L}}
\newcommand{\NNSMLocal}{\mathrm{R}_\mathrm{M1}}
\newcommand{\NNSMArlq}{\mathrm{R}_\mathrm{M,i}}
\newcommand{\NNSCLocal}{\mathrm{R}_\mathrm{C1}}
\newcommand{\NNSMGlobal}{\mathrm{R}_\mathrm{M0}}
\newcommand{\NNSCGlobal}{\mathrm{R}_\mathrm{C0}}
\newcommand{\NNSCArlq}{\mathrm{R}_\mathrm{C,i}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MESH PROBLEM
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Mesh Moving
\newcommand{\domaintt}{\Omega_{\tilde{t}}}
\newcommand{\stressTensorM}{\stressTensor_{M}}
\newcommand{\testfunction}{\mathbf{w}_{M}^h}
\newcommand{\dispM}{\mathbf{z}}
\newcommand{\dispMh}{\bar{\mathbf{z}}^h}
\newcommand{\dispMtth}{\bar{\mathbf{z}}_{\tilde{t}}^h}
\newcommand{\postth}{\posh_{\tilde{t}}}
\newcommand{\tildet}{\tilde{t}}
\newcommand{\poissonm}{\nu_{M}}
\newcommand{\elasticityM}{E_{M}}
\newcommand{\jacM}{J_{M}}
\newcommand{\adimensionalcoordinates}{\boldsymbol{\xi}}
\newcommand{\error}{e_{L2}}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FLUID PROBLEM
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%mathematical commands
\newcommand{\trace}{\mathrm{tr}}
\newcommand{\unittensor}{\mathbf{I}}
\newcommand{\increment}{\varDelta}
\newcommand{\imaginary}{\imath}
\newcommand{\complexspace}{{\mathbb C}}
\newcommand{\laplacian}{\Delta}
\newcommand{\strainrate}{\boldsymbol{{\dot{\varepsilon}}}}
\newcommand{\strainratetensor}{\dot{\bm{\varepsilon}}}
\newcommand{\vzero}{\mathbf{0}}
\newcommand{\deriv}{\mathrm{d}}
\newcommand{\divergence}{\boldsymbol{\nabla}_y}
\newcommand{\gradient}{\boldsymbol{\nabla}_y}
\newcommand{\realspace}{\mathbb{R}}
\newcommand{\nrealspace}{\mathbb{R}^{\nsd}}


%fluid domain
%domain
\newcommand{\domain}{\Omega}
\newcommand{\domainh}{\Omega^h}
\newcommand{\domainT}{\Omega_t}
%element domain
\newcommand{\domainE}{\Omega^e}
%boundary
\newcommand{\boundary}{\Gamma}
\newcommand{\boundaryh}{\Gamma^h}
%Dirichlet boundary
\newcommand{\boundaryD}{\Gamma_{D}}
%Neumann boundary
\newcommand{\boundaryN}{\Gamma_{N}}
%boundary normal vectors^
\newcommand{\snormal}{\mathbf{n}}
\newcommand{\normal}{\mathbf{n}}
%ALE domains
\newcommand{\domainMat}{\Omega_{0}}
\newcommand{\domainRef}{\Omega_{\bar{x}}}
\newcommand{\domainALEN}{\domain_{t_{n+\alpha_{f}}}}

%fluid and flow properties
%density
\newcommand{\density}{\rho}
%dinamic viscosity
\newcommand{\viscosity}{\mu}
%cinematic viscosity
\newcommand{\kviscosity}{\nu}
%difusivity
\newcommand{\diffusivity}{\nu}
\newcommand{\mdiffusivity}{\kappa}
%Reynolds, Strouhal and Peclet
\newcommand{\Reynolds}{\mathrm{Re}}
\newcommand{\Strouhal}{\mathrm{St}}
\newcommand{\Pe}{\mathrm{Pe}}

%boundary conditions
%Dirichlet velocity
\newcommand{\velocityD}{\mathbf{u}_D}
%Neumann force
\newcommand{\surfaceLoad}{\mathbf{h}}
\newcommand{\surfaceLoadh}{\mathbf{h^h}}

%stress tensor and forces
%Cauchy stress tensor
\newcommand{\stressTensor}{\boldsymbol{\sigma}}
\newcommand{\stress}{\sigma}
%unity mass body forces  
\newcommand{\sbodyforce}{\mathbf{f}}
\newcommand{\sbodyforceh}{\mathbf{f^h}}



%ALE description
%mapping functions
\newcommand{\fmapAI}{\mathbf{f}}
\newcommand{\fmapAR}{\mathbf{\bar{f}}}
\newcommand{\fmapRI}{\mathfrak{f}}
%Jacobian mapping matrix
\newcommand{\FmapAI}{\mathbf{F}}
\newcommand{\FmapAR}{\mathbf{\bar{F}}}
\newcommand{\FmapRI}{\mathfrak{F}}
%physical domain position
\newcommand{\pos}{\mathbf{y}}
\newcommand{\posh}{\mathbf{y}^h}
%reference domain position
\newcommand{\posALE}{\bar{\mathbf{x}}}
\newcommand{\posALEh}{\bar{\mathbf{x}}^h}
%material position
\newcommand{\posMat}{\mathbf{x}}



%trial and test functions/trial and test spaces
%velocity vector
\newcommand{\velocity}{\mathbf{u}}
\newcommand{\velocityh}{\mathbf{u}^h}
%ALE velocity
\newcommand{\velocityALE}{\bar{\velocity}}
\newcommand{\velocityALEh}{\bar{\velocity}^h}
%press
\newcommand{\press}{p}
\newcommand{\pressh}{p^h}
%weighting velocity
\newcommand{\utest}{\mathbf{w}}
\newcommand{\utesth}{\mathbf{w}^h}
%weighting press
\newcommand{\ptest}{q}
\newcommand{\ptesth}{q^h}
%velocity solution space
\newcommand{\usolution}{\mathcal{S}_u}
\newcommand{\usolutionh}{\mathcal{S}_u^h}
%press solution space
\newcommand{\psolution}{\mathcal{S}_p}
\newcommand{\psolutionh}{\mathcal{S}_p^h}
%velocity weighting solution space
\newcommand{\uweighting}{\mathcal{V}_u}
\newcommand{\uweightingh}{\mathcal{V}_u^h}
%pressure weighting solution space
\newcommand{\pweighting}{\mathcal{V}_p}
\newcommand{\pweightingh}{\mathcal{V}_p^h}


%stabilization terms
\newcommand{\SUPG}{\tau_{\mathrm{SUPG}}}
\newcommand{\PSPG}{\tau_{\mathrm{PSPG}}}
\newcommand{\SUGNi}{\tau_{\mathrm{SUGN1}}}
\newcommand{\SUGNii}{\tau_{\mathrm{SUGN2}}}
\newcommand{\SUGNiii}{\tau_{\mathrm{SUGN3}}}
\newcommand{\SUGNxii}{\tau_{\mathrm{SUGN12}}}
\newcommand{\LSIC}{\nu_{\mathrm{LSIC}}}
\newcommand{\RGN}{h_{\mathrm{RGN}}}
\newcommand{\RQD}{h_{\mathrm{RQD}}}
\newcommand{\rRGN}{\mathbf{r}}
%patricia new commands for stabilization parameters
\newcommand{\matrixQ}{\mathbf{Q}}
\newcommand{\matrixQhat}{\hat{\mathbf{Q}}}
\newcommand{\matrixD}{\mathbf{D}}
\newcommand{\matrixCinv}{\mathbf{C}^{-1}}
\newcommand{\matrixC}{\mathbf{C}}
\newcommand{\matrixG}{\mathbf{G}}

%residual vectors and degrees of freedom vectors
%residual vectores weak form
\newcommand{\resMom}{\mathbf{r}_{\mathrm{M}}}
\newcommand{\resPre}{{r}_{\mathrm{C}}}
%semi discrete residual vectores
\newcommand{\NNSM}{\mathbf{R}_\mathrm{M}}
\newcommand{\NNSC}{\mathbf{R}_\mathrm{C}}
%velocity degrees of freedom
\newcommand{\Velocity}{\mathbf{U}}
%press degrees of freedom
\newcommand{\Press}{\mathbf{p}}
%acceleration degrees of freedom
\newcommand{\Acceleration}{\mathbf{\dot{U}}}

%boundary conditions names
\newcommand{\patom}{\press_{\mathrm{atm}}}
\newcommand{\pinfty}{\press_{\infty}}
\newcommand{\stressinfty}{\stresstensor_{\infty}}
\newcommand{\velocinfty}{\velocity_{\infty}}


%indexes
\newcommand{\neb}{n_{\mathrm{eb}}}
\newcommand{\nel}{n_{\mathrm{el}}}
\newcommand{\nnos}{n_{\mathrm{nos}}}
\newcommand{\ncp}{n_{\mathrm{np}}}
\newcommand{\nsd}{{n_{\mathrm{sd}}}}
\newcommand{\npd}{{n_{\mathrm{sd}}}}
\newcommand{\itercounter}{i}
\newcommand{\nen}{n_{\mathrm{en}}}

%element finit context 
%shape function index
\newcommand{\shapef}{N}
%element size
\newcommand{\elementsize}{h}
\newcommand{\integrationPoint}{\tilde{\boldsymbol{\xi}}}
\newcommand{\coordAdimen}{\bm{\xi}}


%FSI domain
\newcommand{\domainFSI}{\Omega_{IFE}}
\newcommand{\domainF}{\domain_{F}}
\newcommand{\domainS}{\domain_{E}}
\newcommand{\boundaryFSI}{\Gamma_{IFE}}
\newcommand{\stressTensorS}{\stressTensor_{E}}
\newcommand{\stressTensorF}{\stressTensor_{F}}
\newcommand{\snormalS}{\snormal_{E}}
\newcommand{\snormalF}{\snormal_{F}}
\newcommand{\Nf}{\mathbf{N}_{1}}
\newcommand{\Ns}{\mathbf{N}_{2}}
\newcommand{\Nm}{\mathbf{N}_{3}}
\newcommand{\Ni}{\mathbf{N}_{i}}
\newcommand{\df}{\mathbf{d}_{1}}
\newcommand{\ds}{\mathbf{d}_{2}}
\newcommand{\dm}{\mathbf{d}_{3}}
\newcommand{\djj}{\mathbf{d}_{j}}
\newcommand{\xf}{\mathbf{x}_{1}}
\newcommand{\xs}{\mathbf{x}_{2}}
\newcommand{\xm}{\mathbf{x}_{3}}
\newcommand{\cff}{\mathbf{c}_{1}}
\newcommand{\css}{\mathbf{c}_{2}}
\newcommand{\cmm}{\mathbf{c}_{3}}
\newcommand{\mA}{\mathbf{A}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Isogeometric variables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\xsi}{\xi}
\newcommand{\Xsi}{\Xi}
\newcommand{\CP}{\mathbf{B}}
\newcommand{\Nb}{N^b}
\newcommand{\Nbl}{(N^{b}_{i,p})'}
\newcommand{\Nblc}{(N^{b}_{\hat{i},p})'}
\newcommand{\Mb}{M^b}
\newcommand{\Lb}{L^b}
\newcommand{\fNURBS}{R}